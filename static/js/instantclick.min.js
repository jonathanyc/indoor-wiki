/* InstantClick 3.1.0 | (C) 2014-2015 Alexandre Dieulot | http://instantclick.io/license */
var instantClick,InstantClick=instantClick=function(f,d,C){function u(a){var b=a.indexOf("#");return 0>b?a:a.substr(0,b)}function w(a){for(;a&&"A"!=a.nodeName;)a=a.parentNode;return a}function x(a){var b=d.protocol+"//"+d.host;if(!(b=a.target||a.hasAttribute("download")||0!=a.href.indexOf(b+"/")||-1<a.href.indexOf("#")&&u(a.href)==g))a:{do{if(!a.hasAttribute)break;if(a.hasAttribute("data-instant"))break;if(a.hasAttribute("data-no-instant")){b=!0;break a}}while(a=a.parentNode);b=!1}return b?!1:!0}
function p(a,b,e,D){for(var f=!1,d=0;d<y[a].length;d++)if("receive"==a){var c=y[a][d](b,e,D);c&&("body"in c&&(e=c.body),"title"in c&&(D=c.title),f=c)}else y[a][d](b,e,D);return f}function H(a,b,e,c,d){f.documentElement.replaceChild(b,f.body);if(e){history.pushState(null,null,e);b=e.indexOf("#");b=-1<b&&f.getElementById(e.substr(b+1));c=0;if(b)for(;b.offsetParent;)c+=b.offsetTop,b=b.offsetParent;scrollTo(0,c);g=u(e)}else scrollTo(0,c);f.title=N&&f.title==a?a+String.fromCharCode(160):a;I();d?p("restore"):
p("change",!1)}function J(a){E>+new Date-500||(a=w(a.target))&&x(a)&&r(a.href)}function K(a){E>+new Date-500||(a=w(a.target))&&x(a)&&(a.addEventListener("mouseout",O),F?(L=a.href,k=setTimeout(r,F)):r(a.href))}function P(a){E=+new Date;(a=w(a.target))&&x(a)&&(z?a.removeEventListener("mousedown",J):a.removeEventListener("mouseover",K),r(a.href))}function Q(a){var b=w(a.target);!b||!x(b)||1<a.which||a.metaKey||a.ctrlKey||(a.preventDefault(),G(b.href))}function O(){k?(clearTimeout(k),k=!1):t&&!c&&(l.abort(),
c=t=!1)}function R(){if(!(4>l.readyState)&&0!=l.status){m.ready=+new Date-m.start;if(l.getResponseHeader("Content-Type").match(/\/(x|ht|xht)ml/)){var a=f.implementation.createHTMLDocument("");a.documentElement.innerHTML=l.responseText.replace(/<noscript[\s\S]+?<\/noscript>/gi,"");v=a.title;q=a.body;var b=p("receive",n,q,v);b&&("body"in b&&(q=b.body),"title"in b&&(v=b.title));b=u(n);h[b]={body:q,title:v,scrollY:b in h?h[b].scrollY:0};for(var a=a.head.children,b=0,e,d=0;d<a.length;d++)if(e=a[d],e.hasAttribute("data-instant-track")){e=
e.getAttribute("href")||e.getAttribute("src")||e.innerHTML;for(var g=0;g<A.length;g++)A[g]==e&&b++}b!=A.length&&(B=!0)}else B=!0;c&&(c=!1,G(n))}}function S(){var a=u(d.href);a!=g&&(a in h?(h[g].scrollY=pageYOffset,g=a,H(h[a].title,h[a].body,!1,h[a].scrollY,!0)):d.href=d.href)}function I(a){f.body.addEventListener("touchstart",P,!0);z?f.body.addEventListener("mousedown",J,!0):f.body.addEventListener("mouseover",K,!0);f.body.addEventListener("click",Q,!0);if(!a){a=f.body.getElementsByTagName("script");
for(var b,e,c,d,g=0,h=a.length;g<h;g++)b=a[g],b.hasAttribute("data-no-instant")||(e=f.createElement("script"),b.src&&(e.src=b.src),b.innerHTML&&(e.innerHTML=b.innerHTML),c=b.parentNode,d=b.nextSibling,c.removeChild(b),c.insertBefore(e,d))}}function r(a){!z&&"display"in m&&100>+new Date-(m.start+m.display)||(k&&(clearTimeout(k),k=!1),a||(a=L),t&&(a==n||c))||(t=!0,c=!1,n=a,B=q=!1,m={start:+new Date},p("fetch"),l.open("GET",a),l.send())}function G(a){"display"in m||(m.display=+new Date-m.start);k||!t?
k&&n&&n!=a?d.href=a:(r(a),p("wait"),c=!0):c?d.href=a:B?d.href=n:q?(h[g].scrollY=pageYOffset,c=t=!1,H(v,q,n)):(p("wait"),c=!0)}var N=-1<C.indexOf(" CriOS/"),g,L,k,E,h={},l,n=!1,v=!1,B=!1,q=!1,m={},t=!1,c=!1,A=[],z,F,y={fetch:[],receive:[],wait:[],change:[],restore:[]},M="pushState"in history&&(!C.match("Android")||C.match("Chrome/"))&&"file:"!=d.protocol;return{supported:M,init:function(a){if(!g)if(M){"mousedown"==a?z=!0:"number"==typeof a&&(F=a);g=u(d.href);h[g]={body:f.body,title:f.title,scrollY:pageYOffset};
a=f.head.children;for(var b,c=0;c<a.length;c++)b=a[c],b.hasAttribute("data-instant-track")&&(b=b.getAttribute("href")||b.getAttribute("src")||b.innerHTML,A.push(b));l=new XMLHttpRequest;l.addEventListener("readystatechange",R);I(!0);p("change",!0);addEventListener("popstate",S)}else p("change",!0)},on:function(a,b){y[a].push(b)},display:G,preload:r}}(document,location,navigator.userAgent);
